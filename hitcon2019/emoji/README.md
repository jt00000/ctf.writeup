# å­¦ã³
è«¦ã‚ãªã„ã“ã“ã‚ã€‚  
revã ã‘1æ—¥åŠã‹ã‘ã¦ã€çµ‚äº†10åˆ†å‰ã§è§£ã‘ãŸã€‚  
çµ‚ã‚ã£ã¦2æ—¥ãã‚‰ã„ã‚„ã‚Šç¶šã‘ã¦pwnã¨miscã‚‚è§£ã‘ãŸã€‚  
ä¸Šä½ãƒãƒ¼ãƒ ã¯åŠæ—¥ãã‚‰ã„ã§å…¨éƒ¨å–ã£ã¦ãŸã®ã§ã€å°‘ãªãã¨ã‚‚è§£æã«ã‹ã‹ã‚‹æ™‚é–“ã‚’1/4ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚  

è§£ææ™‚é–“ã®çŸ­ç¸®ã«å½“ãŸã‚Šã€æ–¹é‡ãŒèª²é¡Œã®ï¼‘ã¤æ°—ãŒã—ã¦ã„ã¦ã€vmå•ã§å…¥åŠ›ä½œã‚‰ã›ã‚‹ç³»ã¯çµ¶å¯¾ã‚³ãƒãƒ³ãƒ‰å…¨éƒ¨è¦‹ã¦ç†è§£ã—ã¦ãŠãã¹ãã ã¨æ€ã£ãŸã€‚è¿·ã†ã‹ã‚‰ã€‚

## çµµæ–‡å­—
æœ€çµ‚çš„ã«ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ãŸã€‚ 
```
0x01, 0x1f233, ğŸˆ³, nop
0x02, 0x02795, â•, [reg-1] = [reg]+[reg-1]; reg = reg - 1
0x03, 0x02796, â–, [reg-1] = [reg]-[reg-1]; reg = reg - 1
0x04, 0x0274c, âŒ, [reg-1] = [reg]*[reg-1]; reg = reg - 1
0x05, 0x02753, â“, [reg-1] = [reg]%[reg-1]; reg = reg - 1
0x06, 0x0274e, â, [reg-1] = [reg]^[reg-1]; reg = reg - 1
0x07, 0x1f46b, ğŸ‘«, [reg-1] = [reg]&[reg-1]; reg = reg - 1
0x08, 0x1f480, ğŸ’€, if [reg] < [reg-1] then [reg-1]=1 else [reg-1]=0;reg = reg - 1
0x09, 0x1f4af, ğŸ’¯, if [reg] == [reg-1] then [reg-1]=1 else [reg-1]=0;reg = reg - 1 
0x0a, 0x1f680, ğŸš€, jmp to reg
0x0b, 0x1f236, ğŸˆ¶, if [reg-1] == 0 then reg = reg-2 else ip = reg, reg = reg-2
0x0c, 0x1f21a, ğŸˆš, if [reg-1] == 0 then ip = reg, reg = reg-2 else reg = reg-2 
0x0d, 0x023ec, â¬, reg+1 = ip+1; ip+=2
0x0e, 0x1f51d, ğŸ”, reg-=1
0x0f, 0x1f4e4, ğŸ“¤, [reg+1] = buf[[reg]][reg-1]; reg+=1
0x10, 0x1f4e5, ğŸ“¥, buf[[reg]][reg-1] = [reg-2]; reg-=3
0x11, 0x1f195, ğŸ†•, malloc([reg]); reg-=1
0x12, 0x1f193, ğŸ†“, free([reg]); reg-=1
0x13, 0x1f4c4, ğŸ“„, read(0, reg, len(reg)); reg-=1
0x14, 0x1f4dd, ğŸ“, write(1, reg, len(reg)); reg-=1
0x15, 0x1f521, ğŸ”¡, copy???
0x16, 0x1f522, ğŸ”¢, printf(reg);???
0x17, 0x1f6d1, ğŸ›‘, exit()

0x00, 0x1f600, ğŸ˜€
0x01, 0x1f601, ğŸ˜
0x02, 0x1f602, ğŸ˜‚
0x03, 0x1f923, ğŸ¤£
0x04, 0x1f61c, ğŸ˜œ
0x05, 0x1f604, ğŸ˜„
0x06, 0x1f605, ğŸ˜…
0x07, 0x1f606, ğŸ˜†
0x08, 0x1f609, ğŸ˜‰
0x09, 0x1f60a, ğŸ˜Š
0x0a, 0x1f60d, ğŸ˜
```

## rev
çµµæ–‡å­—ã‚’è§£é‡ˆã—ã¦ã„ã‚‹ã¨ã“ã‚ã‹ã‚‰çµµæ–‡å­—ã¨ãã®å‹•ãã‚’ç‰¹å®šã™ã‚‹ã€‚  
ã“ã®å¾Œã¯ã€æ¯”è¼ƒã‚’ã‚„ã‚‹çµµæ–‡å­—ã«å¯¾ã—ã¦ãƒ–ãƒ¬ãƒ¼ã‚¯ã‹ã‘ã¦æ¯”è¼ƒå€¤ã‚’è¦‹ã‚‹æ–¹é‡ãŒè‰¯ã•ãã†ã€‚  
ã“ã‚Œã«ã‚ˆã‚‹ã¨ã€ã¾ãšå…¥åŠ›ãŒ```XXXX-XXXX-XXXX-XXXX-XXXX```ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã€‚  
æ¬¡ã«1æ–‡å­—ã”ã¨ã«æ¯”è¼ƒã‚’å–ã£ã¦ã„ãã€‚æ¼”ç®—ç”¨ã«ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ã‚‹ã‚ˆã†ã§ã€æ–‡å­—ãŒãã®ã¾ã¾æ¯”è¼ƒã•ã‚Œã‚‹ã‚ã‘ã§ã¯ãªã„ã€‚   
æ¯”è¼ƒé–¢æ•°ã§ãƒ–ãƒ¬ãƒ¼ã‚¯ã—ã¦ã€åˆã†ã‚ˆã†ã«æ–‡å­—ã‚’å¤‰ãˆã¦èª¿æ•´ã—ãŸã€‚

```
$ ./emojivm chal.evm 
*************************************
*                                   *
*             Welcome to            *
*        EmojiVM ğŸ˜€ğŸ˜ğŸ¤£ğŸ¤”ğŸ¤¨ğŸ˜®       *
*       The Reverse Challenge       *
*                                   *
*************************************

Please input the secret: plis-g1v3-me33-th3e-f14g
ğŸ˜
hitcon{R3vers3_Da_3moj1}
```

ä¸–ã®ä¸­ã«ã¯gdb scriptãŒã‚ã£ã¦ã€ãã‚Œã‚’ä½¿ã£ã¦è§£ãã®ãŒã¾ã£ã¨ã†ãªã‚„ã‚Šæ–¹ã ã¨æ€ã†ã®ã§ç¿’å¾—ã™ã‚‹ã€‚

## misc
ï¼™ï½˜ï¼™ã®æ›ã‘ç®—ã‚’è¡¨ç¤ºã§ããŸã‚‰å‹ã¡ã€‚ç«¶æŠ€æ™‚é–“ã¯ã»ã¼æœªç€æ‰‹ã€‚  
```
1 * 1 = 1
1 * 2 = 2
...
```
è§£ç­”ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãã®ã¾ã¾å…¥åŠ›ã—ã¦è¡¨ç¤ºã—ãŸã‚‰ï¼Ÿ  
â†’ã“ã®å•é¡Œã®emojivmã ã‘ã¯å®Ÿè¡Œå¾Œã®å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ãªã„ã€‚(pwnã®æµç”¨ã‚’é˜²ããŸã‚)

å‡ºåŠ›å†…å®¹ã‚’å…¨éƒ¨çµµæ–‡å­—ã«ã—ãŸã‚‰ï¼Ÿ  
â†’æ–‡å­—ãŒè¶³ã‚‰ã‚“ï¼ˆ2000byteï¼‰

ã¨ã„ã†ã“ã¨ã§ã€ï¼”ã¤ã®ãƒãƒƒãƒ•ã‚¡ã«åˆ†ã‘ã¦ã€
- å·¦ã®æ•°å­—
- ```" * "```
- å³ã®æ•°å­—
- ```" = "```
- ```\x0a```

ã¨ã—ã¦ã¾ã£ã¨ã†ã«äºŒé‡ãƒ«ãƒ¼ãƒ—ã‚’çµ„ã¿ç«‹ã¦ãŸã€‚
```
[*] Switching to interactive mode
[DEBUG] Received 0x1 bytes:
    '\n'

[DEBUG] Received 0x55 bytes:
    "Good job ! Here's the flag:\n"
    'hitcon{M0mmy_I_n0w_kN0w_h0w_t0_d0_9x9_em0j1_Pr0gr4mM!ng}\n'
```

## pwn
ã‚·ã‚§ãƒ«å–ã‚‹ã ã‘ã€‚ã“ã¡ã‚‰ã‚‚æœªç€æ‰‹ã€‚
ã‚¹ã‚¿ãƒƒã‚¯ã«ãªã£ã¦ã‚‹éƒ¨åˆ†ã®è² ã®ã¨ã“ã‚ã€ã„ãã¤ã‹ã®å‘½ä»¤ã«ã¯-1ã«ãªã£ãŸã‚‰ã‚¨ãƒ©ãƒ¼ã«ã™ã‚‹ã‚‚ã®ãŒã‚ã‚‹ãŒã€æ¡ä»¶åˆ†å²ãªã©ã§æ¸›ã‚‹ã‚‚ã®ã«ã¤ã„ã¦ã¯ãŠå’ã‚ãŒãªã„ã€‚  
ã‚¹ã‚¿ãƒƒã‚¯ã‚ˆã‚Šè‹¥ã„ã¨ã“ã‚ã«ä½•ãŒã‚ã‚‹ã®ã‹ã¨ã„ã†ã¨ã€ãƒãƒƒãƒ•ã‚¡ã®ãƒã‚¤ãƒ³ã‚¿ãŒä¸¦ã‚“ã§ã„ã‚‹ã€‚  
ä»»æ„ã®ã‚µã‚¤ã‚ºã§ãƒãƒƒãƒ•ã‚¡ã‚’ç¢ºä¿ã§ãã‚‹ã®ã§ã€0x420ã®ãƒãƒ£ãƒ³ã‚¯ã‚’ãƒ•ãƒªãƒ¼ã•ã›ã¦ã€ãƒã‚¤ãƒ³ã‚¿ã‚’å¾©å…ƒã—ã¦ãƒªãƒ¼ã‚¯ã•ã›ã€tcache dupã‚’ä½œã£ã¦free("/bin/sh")ã®å½¢ã«æŒã£ã¦ã„ã£ãŸã€‚
```
[+] Opening connection to 3.115.176.164 on port 30262: Done
[+] Starting local process '/bin/sh': pid 6671
[*] Stopped process '/bin/sh' (pid 6671)
heap: 0x55d751ba2e10
libc: 0x7f8240185000
[*] Switching to interactive mode
...
$ cat f*
hitcon{H0p3_y0u_Enj0y_pWn1ng_th1S_3m0j1_vM_^_^b}
```
